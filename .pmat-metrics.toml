# O(1) Quality Gate Metric Thresholds for Jugar
# Spec: Phase 2 O(1) Quality Gates with hash-based caching
# Pattern: Toyota Way - Jidoka (MEAN mode: warnings = errors)

[thresholds]
# Hard limits (block commits) - based on tiered workflow targets
lint_max_ms = 30_000              # 30s (Tier 1 target: sub-second lint-fast)
lint_full_max_ms = 60_000         # 60s (Tier 2 target: full clippy)
test_tier1_max_ms = 5_000         # 5s (Tier 1 target: sub-second focused tests)
test_tier2_max_ms = 300_000       # 5min (Tier 2 target: 1-5min full tests)
coverage_max_ms = 600_000         # 10min (Tier 2 coverage analysis)
bench_max_ms = 600_000            # 10min (Tier 3 benchmarks)
binary_max_bytes = 2_000_000      # 2MB (WASM bundle size budget)

# Soft limits (warnings only) - Tier 3 targets
build_release_max_ms = 300_000    # 5min (WASM build time)
mutation_test_max_ms = 3_600_000  # 60min (Tier 3 mutation testing)
fuzz_test_max_ms = 600_000        # 10min (Tier 3 fuzzing)

# WASM-specific thresholds
wasm_build_max_ms = 120_000       # 2min (WASM release build)
wasm_opt_max_ms = 60_000          # 1min (wasm-opt optimization)

[staleness]
# Metrics older than this trigger warnings
max_age_days = 7

[enforcement]
# Pre-commit behavior (MEAN mode = strict)
fail_on_stale_metrics = false     # Warn, don't block
fail_on_missing_metrics = false   # Allow commits if no cache
fail_on_threshold_violation = true # Block commits on violations (MEAN mode)

[trend_analysis]
# Track metrics for Kaizen (continuous improvement)
enabled = true
retention_days = 90
alert_on_regression = true
regression_threshold_pct = 10.0   # Alert if >10% slower

# Jugar-specific quality gates
[quality_gates]
# EXTREME TDD targets (certeza-inspired)
min_coverage_pct = 95.0           # Target: ≥95% line coverage (per CLAUDE.md)
min_mutation_score_pct = 80.0     # Target: ≥80% mutation score
max_cyclomatic_complexity = 20    # Target: ≤20 per function
min_tdg_grade = "B+"              # Target: B+ or better (≥85)
max_unsafe_blocks = 50            # Game engine may need some unsafe
max_unwrap_calls = 0              # Zero tolerance - use proper error handling

# Performance budgets (game engine targets)
[performance]
# Frame timing targets
min_fps = 60                      # 60 FPS minimum
max_frame_time_ms = 16.67         # 16.67ms per frame budget
max_fixed_dt_ms = 16.67           # Fixed timestep budget

# WASM size budget
max_wasm_size_bytes = 2_000_000   # 2MB total
max_wasm_gzip_bytes = 500_000     # 500KB gzipped

# Startup performance
max_startup_ms = 500              # <500ms on mobile (per spec)
