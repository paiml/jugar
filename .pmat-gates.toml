# PMAT Quality Gate Configuration for Jugar
# WASM-native game engine with EXTREME TDD standards
# Aligned with pmat.toml and CLAUDE.md requirements

[gates]
# Run clippy linter
run_clippy = true

# Enforce strict clippy (-D warnings)
clippy_strict = true

# Run test suite
run_tests = true

# Test timeout in seconds
test_timeout = 600

# Check code coverage
check_coverage = true

# Minimum coverage percentage (95% per CLAUDE.md - NON-NEGOTIABLE)
min_coverage = 95.0

# Check cyclomatic complexity
check_complexity = true

# Maximum cyclomatic complexity per function
max_complexity = 20

# Maximum cognitive complexity per function
max_cognitive_complexity = 15

# Check for SATD (Self-Admitted Technical Debt)
check_satd = true

# Maximum SATD comments allowed (zero tolerance)
max_satd = 0

# Check for known defects (v2.200.0)
check_defects = true

# Fail on .unwrap() calls
fail_on_unwrap = true

# Technical Debt Grading
check_tdg = true

# Minimum TDG grade
min_tdg_grade = "B+"

# Code duplication detection
check_duplication = true

# Maximum code duplication percentage
max_duplication = 5.0

# Mutation testing (disabled for pre-commit, enabled in CI)
check_mutation = false

# Minimum mutation score (when enabled)
min_mutation_score = 80.0

# Repository health score
check_repo_score = false  # Too slow for pre-commit

# Minimum repo score (when enabled)
min_repo_score = 90

# Rust project score
check_rust_project_score = false  # Too slow for pre-commit

# Minimum Rust project score (when enabled)
min_rust_project_score = 150

# Documentation validation
check_documentation = false  # Slow, run in CI

# Security audit
check_security = false  # Slow, run in CI

# Formatting check
check_format = true

# Block commit on any failure
block_on_failure = true

# Mode: strict | warning | disabled
mode = "strict"

# WASM-specific gates
[gates.wasm]
# Check WASM binary size
check_binary_size = true
max_binary_size_bytes = 2_000_000  # 2MB

# Verify WASM SIMD support
require_simd = true

[compute-brick]
enabled = true
require_safety_comments = true
require_target_feature = true
cv_threshold_percent = 15.0
efficiency_threshold_percent = 25.0
